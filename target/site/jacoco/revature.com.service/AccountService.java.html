<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AccountService.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">project0</a> &gt; <a href="index.source.html" class="el_package">revature.com.service</a> &gt; <span class="el_source">AccountService.java</span></div><h1>AccountService.java</h1><pre class="source lang-java linenums">package revature.com.service;

import java.util.List;

import org.apache.log4j.Logger;

import revature.com.dao.AccountDao;
import revature.com.dao.AccountDaoInterface;
import revature.com.dao.UserDao;
import revature.com.dao.UserDaoInterface;
import revature.com.exceptions.AccountNotActiveException;
import revature.com.exceptions.InsufficientBalanceException;
import revature.com.exceptions.InvalidAmountOfMoneyException;
import revature.com.exceptions.NoAccountsExistException;
import revature.com.models.Account;
import revature.com.models.User;

<span class="nc" id="L18">public class AccountService {</span>

<span class="nc" id="L20">	private AccountDaoInterface adao = new AccountDao();</span>
<span class="nc" id="L21">	private UserDaoInterface udao = new UserDao();</span>

	// Log4j
<span class="nc" id="L24">	Logger logger = Logger.getLogger(AccountService.class);</span>

	public void viewAllActiveAccounts() {
<span class="nc" id="L27">		List&lt;Account&gt; accList = adao.findAll();</span>
<span class="nc bnc" id="L28" title="All 2 branches missed.">		if (accList.isEmpty()) {</span>
<span class="nc" id="L29">			throw new NoAccountsExistException(&quot;No accounts found!&quot;);</span>
		}
<span class="nc bnc" id="L31" title="All 2 branches missed.">		for (Account a : accList) {</span>
<span class="nc bnc" id="L32" title="All 2 branches missed.">			if (a.isActive()) {</span>
<span class="nc" id="L33">				System.out.println(a);</span>
			}
<span class="nc" id="L35">		}</span>
<span class="nc" id="L36">	}</span>

	
	public void viewAllDisabledAccounts() {
<span class="nc" id="L40">		List&lt;Account&gt; accList = adao.findAll();</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">		if (accList.isEmpty()) {</span>
<span class="nc" id="L42">			throw new NoAccountsExistException(&quot;No accounts found!&quot;);</span>
		}
<span class="nc bnc" id="L44" title="All 2 branches missed.">		for (Account a : accList) {</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">			if (!a.isActive()) {</span>
<span class="nc" id="L46">				System.out.println(a);</span>
			}
<span class="nc" id="L48">		}</span>
<span class="nc" id="L49">	}</span>

	public void viewAllAccounts() {

<span class="nc" id="L53">		logger.info(&quot;Fetching accounts...&quot;);</span>

<span class="nc" id="L55">		List&lt;Account&gt; accList = adao.findAll();</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">		if (accList.isEmpty()) {</span>
<span class="nc" id="L57">			throw new NoAccountsExistException(&quot;No accounts found!&quot;);</span>
		}
<span class="nc bnc" id="L59" title="All 2 branches missed.">		for (Account a : accList) {</span>
<span class="nc" id="L60">			System.out.println(a);</span>
<span class="nc" id="L61">		}</span>
<span class="nc" id="L62">	}</span>

	
	public void viewOwnerAccListById(int userId) {
<span class="nc" id="L66">		List&lt;Account&gt; accList = adao.findByOwner(userId);</span>
<span class="nc bnc" id="L67" title="All 2 branches missed.">		if (accList.isEmpty()) {</span>
<span class="nc" id="L68">			throw new NoAccountsExistException(&quot;No accounts found!&quot;);</span>
		}
<span class="nc bnc" id="L70" title="All 2 branches missed.">		for (Account a : accList) {</span>
<span class="nc" id="L71">			System.out.println(a);</span>
<span class="nc" id="L72">		}</span>

<span class="nc" id="L74">	}</span>

	public void viewAccById(int id) {
<span class="nc" id="L77">		Account a = adao.findById(id);</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">		if(a.getId()==0) {</span>
<span class="nc" id="L79">			throw new NoAccountsExistException(&quot;Account doesn't exist with this id&quot;);</span>
		}
<span class="nc" id="L81">		System.out.println(a);</span>
<span class="nc" id="L82">	}</span>
	public void approveAcById(int id) {
<span class="nc" id="L84">		Account a = adao.findById(id);</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">		if(a.getId()==0) {</span>
<span class="nc" id="L86">			throw new NoAccountsExistException(&quot;Account doesn't exist with this id&quot;);</span>
		}
<span class="nc" id="L88">		adao.alterActivityById(id, true);</span>
<span class="nc" id="L89">		System.out.println(&quot;Account activated/approved&quot;);</span>
<span class="nc" id="L90">	}</span>

	public void denyAcById(int id) {
<span class="nc" id="L93">		Account a = adao.findById(id);</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">		if(a.getId()==0) {</span>
<span class="nc" id="L95">			throw new NoAccountsExistException(&quot;Account doesn't exist with this id&quot;);</span>
		}
<span class="nc" id="L97">		adao.alterActivityById(id, false);</span>
<span class="nc" id="L98">		System.out.println(&quot;Account disabled/denied&quot;);</span>
<span class="nc" id="L99">	}</span>

	// Withdraws amount from account using account id
	public double withdraw(double amount, int id, int custId) {

<span class="nc" id="L104">		Account a = adao.findById(id);</span>

		// Get the user ID to match it
<span class="nc" id="L107">		User u = udao.findById(custId);</span>

<span class="nc bnc" id="L109" title="All 2 branches missed.">		if (u != null) {</span>
<span class="nc bnc" id="L110" title="All 2 branches missed.">			if (u.getId() != a.getUsers_a_id()) {</span>
<span class="nc" id="L111">				throw new NoAccountsExistException(&quot;No such accounts with this id = &quot; + id); // this is for the user's</span>
																								// Account list only not
																								// all accounts in the
																								// bank
			}
		}
<span class="nc bnc" id="L117" title="All 2 branches missed.">		if (adao.getStatusById(id) == false) {</span>
<span class="nc" id="L118">			throw new AccountNotActiveException(&quot;your account(s) are inactive. Call an admin/employee&quot;);</span>
		}
<span class="nc bnc" id="L120" title="All 2 branches missed.">		if (amount &lt;= 0) {</span>
<span class="nc" id="L121">			throw new InvalidAmountOfMoneyException(&quot;Amount to withdraw must be greater than 0 $&quot;);</span>
		}
<span class="nc bnc" id="L123" title="All 2 branches missed.">		if (amount &gt; a.getBalance()) {</span>
<span class="nc" id="L124">			throw new InsufficientBalanceException(&quot;Sorry, insufficient funds in your account&quot;);</span>
		}

		// If all of the above pass, then balance will be updated.
<span class="nc" id="L128">		double newBalance = a.getBalance() - amount;</span>

<span class="nc" id="L130">		adao.updateBalanceById(newBalance, id);</span>

<span class="nc" id="L132">		return newBalance;</span>

	}

	// Deposit amount to account using id
	public double deposit(double amount, int id, int custId) {

<span class="nc" id="L139">		Account a = adao.findById(id);</span>

		// Get the user ID to match it
<span class="nc" id="L142">		User u = udao.findById(custId);</span>

<span class="nc bnc" id="L144" title="All 2 branches missed.">		if (u != null) {</span>
<span class="nc bnc" id="L145" title="All 2 branches missed.">			if (u.getId() != a.getUsers_a_id()) {</span>
<span class="nc" id="L146">				throw new NoAccountsExistException(&quot;No such accounts with this id = &quot; + id); // this is for the user's</span>
																								// Account list only not
																								// all accounts in the
																								// bank
			}
		}
<span class="nc bnc" id="L152" title="All 2 branches missed.">		if (adao.getStatusById(id) == false) {</span>
<span class="nc" id="L153">			throw new AccountNotActiveException(&quot;your account(s) are inactive. Call an admin/employee&quot;);</span>
		}
<span class="nc bnc" id="L155" title="All 2 branches missed.">		if (amount &lt;= 0) {</span>
<span class="nc" id="L156">			throw new InvalidAmountOfMoneyException(&quot;Amount to deposit must be greater than 0 $&quot;);</span>
		}

		// If all of the above pass, then balance will be updated.
<span class="nc" id="L160">		double newBalance = a.getBalance() + amount;</span>

<span class="nc" id="L162">		adao.updateBalanceById(newBalance, id);</span>

<span class="nc" id="L164">		return newBalance;</span>

	}

	public void transfer(double amount, int accFrom, int accTo, int custId) {

<span class="nc" id="L170">		Account aFrom = adao.findById(accFrom);</span>
<span class="nc" id="L171">		Account aTo = adao.findById(accTo);</span>

<span class="nc" id="L173">		User u = udao.findById(custId);</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">		if (u != null) {</span>
<span class="nc bnc" id="L175" title="All 4 branches missed.">			if (u.getId() != aFrom.getUsers_a_id() || u.getId() != aTo.getUsers_a_id()) {</span>
<span class="nc" id="L176">				throw new NoAccountsExistException(&quot;No such account(s) with with the provided id(s)&quot;); // this is for</span>
																										// the user's
																										// Account list
																										// only not all
																										// accounts in
																										// the bank
			}
		}
<span class="nc bnc" id="L184" title="All 4 branches missed.">		if (adao.getStatusById(accFrom) == false || adao.getStatusById(accTo) == false) {</span>
<span class="nc" id="L185">			throw new AccountNotActiveException(&quot;your account(s) are inactive. Call an admin/employee&quot;);</span>
		}
<span class="nc bnc" id="L187" title="All 2 branches missed.">		if (amount &lt;= 0) {</span>
<span class="nc" id="L188">			throw new InvalidAmountOfMoneyException(&quot;Amount to transfer must be greater than 0 $&quot;);</span>
		}
<span class="nc bnc" id="L190" title="All 2 branches missed.">		if (amount &gt; aFrom.getBalance()) {</span>
<span class="nc" id="L191">			throw new InsufficientBalanceException(&quot;Sorry, insufficient funds in your account&quot;);</span>
		}

		// If all of the above pass, then balances in both accounts will be updated.
		// TRANSFER FROM
<span class="nc" id="L196">		double newBalanceFrom = aFrom.getBalance() - amount;</span>
<span class="nc" id="L197">		adao.updateBalanceById(newBalanceFrom, accFrom);</span>
		// TO
<span class="nc" id="L199">		double newBalanceTo = aTo.getBalance() + amount;</span>
<span class="nc" id="L200">		adao.updateBalanceById(newBalanceTo, accTo);</span>

<span class="nc" id="L202">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>